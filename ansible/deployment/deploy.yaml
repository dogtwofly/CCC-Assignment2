---
- hosts: localhost
  vars_files: 
    - host_vars/nectar.yaml
  gather_facts: true
  roles: 
    - role: openstack-common
    - role: openstack-images
    - role: openstack-volume
#    - role: openstack-proxy
    - role: openstack-security-group
    - role: openstack-instances

- hosts: common
  vars_files:
    - host_vars/wordpress.yaml
  gather_facts: True
  pre_tasks:
    - name: 'Install Python' 
      raw: sudo apt-get install update; sudo apt-get -y install python; sudo mkdir /etc/systemd/system/docker.service.d; sudo apt-get install apache2; sudo apt-get install nodejs
  roles:
    - role: wordpress-common
    - role: wordpress-docker
    - role: wordpress-proxy
    - role: wordpress-volumes
    - role: wordpress-wordpress
- hosts: db
  roles:
    - role: wordpress-couchdb